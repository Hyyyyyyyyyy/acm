#include<set> 
#include<stack>
#include<cmath>
#include<queue>
#include<cctype>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<sstream>
#include<iostream>
#include<algorithm>
#define rep(i,a,b) for(i=a;i<=b;i++)
#define rec(i,a)   for(i=0;i<a;i++)
#define N 10000  +  10
#define Q 1000   +  10
#define P 100    +  1
#define Umax 9999999
using namespace std;
int n,m;
int i,j,k;
int x,y,s;
int a[P][P]={0};
int mark[P]={0};
int dis[P]={0}; 
void prim()
{
	int i,j;
	int sum=0;
	for(i=1;i<=m;i++)
	{
		dis[i]=a[1][i];
	}
	mark[1]=1;
	for(i=1;i<m;i++)
	{
		int minx=Umax;
		int position;
		for(j=1;j<=m;j++)
		{
			if(mark[j]==0&&dis[j]<minx)
			{
				minx=dis[j];
				position=j;
			}
			
		}
		sum+=minx;
		mark[position]=1;
		for(j=1;j<=m;j++)
		{
		     if(mark[j]==0&&a[position][j]<dis[j])
		     {
     			a[position][j]=dis[j];
     		 }
		}
	}
	if(sum>=Umax)
	{
		printf("?\n");
	}
	else
	{
		printf("%d\n",sum);
	}
}
int main()
{
	int n,m;
	while(scanf("%d%d",&n,&m)==2)
	{
		if(n==0)break;
		for(i=1;i<=m;i++)
		{
			for(j=1;j<=m;j++)
			{
				if(i==j)
				{
				a[i][j]=0;
				}
				else 
				a[i][j]=Umax;
			}
		}
		for(i=1;i<=n;i++)
		{
			scanf("%d%d%d",&x,&y,&s);
			if(s<a[x][y])
			{
				a[x][y]=a[y][x]=s;
			}
		}
		prim();
		memset(a,0,sizeof a);
		memset(dis,0,sizeof dis);
		memset(mark,0,sizeof mark);
	}
return 0;
}
